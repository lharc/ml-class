<!DOCTYPE html>
<html>
<head>
<meta charset='utf-8'>
<script src='https://code.jquery.com/jquery-3.0.0.min.js'
        integrity='sha256-JmvOoLtYsmqlsWxa7mDSLMwa6dZ9rrIdtrrVYRnDRH0='
        crossorigin='anonymous'></script>
<script src='//d3js.org/d3.v4.min.js'></script>
<script src='utils.js'></script>

<style>
  svg {
    border: 1px solid black;
    background: white;
  }

  .axis .domain, .axis .tick {
    stroke: #000;
    fill: none;
  }

  .title {
    fill: #666;
    font-family: Helvetica, sans-serif;
    text-anchor: middle;
    font-size: 20px;
  }
  .crosshair {
    fill: #fcc;
    stroke: #444;
  }
  .table {
    border: 1px solid #aaa;
    border-top-color: transparent;
    border-bottom-color: transparent;
    border-collapse: collapse;
  }
  .th, .td {
    border: 1px solid #ccc;
    text-align: left;
  }
  .th, .tr {
    border: 1px solid #ccc;
    text-align: left;
  }

</style>
</head>
<body>
<div id='table'></div>
<p>The above table shows the sales figures for some candy store. The amount of sold icecream is per week. And for each weeks reported sales number, the air temperature is also reported.  </p>
<p> The plot below shows how the amount of sold icecream varies with the temperature.</p>
<div id='chart'></div>
<hr>
<p><small>Copyright 2016 (c) Larry Valkama -- License: CC BY 4.0 (also see <a href='Thanks.txt'> Thanks </a>)</small></p>
<div id=logoutput></div>

<script>

var width  = 800;
var height = 600;
var titleHeight = 40;

var yAxisWidth = 50;
var xAxisHeight = 50;
var plotWidth = width - yAxisWidth;
var plotHeight = height - xAxisHeight - titleHeight;

var points = d3.range(20).map(function() {
                                x = Math.trunc(Math.random() * 50); // x is the temperature
                                y = Math.trunc(x + Math.random() * 20);         // sold ice-creams
                                return [x,y];
                             });

var tab = d3.select('#table').append('table').attr('class', 'table');
tab.selectAll('my tr')
    .data([['Temperature', 'Number of sold Icecream']]).enter()
    .append('tr')
    .attr('class', 'tr')
  .selectAll('my td')
    .data(Object).enter()
    .append('td')
    .text(function(d){ return d});

tab.selectAll('my tr')
    .data(points).enter()
    .append('tr')
  .selectAll('my td')
    .data(Object).enter()
    .append('td')
    .attr('class', 'td')
    .text(function(d){ return d});

var dataXmin = d3.min(points, function(d){return d[0]}),
    dataXmax = d3.max(points, function(d){return d[0]}),
    dataYmin = d3.min(points, function(d){return d[1]}),
    dataYmax = d3.max(points, function(d){return d[1]});

var svg = d3.select('#chart').append('svg')
    .attr('width', width)
    .attr('height', height);

svg.append('text')
   .attr('class', 'title')
   .attr('x', width/2)
   .attr('y', titleHeight/2).text('Icecream Sale Figures');

var x = d3.scaleLinear().domain([0          , dataXmax+20])
                        .range ([0          , plotWidth  ]),
    y = d3.scaleLinear().domain([0          , dataYmax+20])
                        .range ([plotHeight , 0          ]);

var xAxis = d3.axisBottom(x).ticks(5),
    yAxis = d3.axisLeft(y).ticks(5);

var g = svg.append('g') // this g translates into the plot area
    .attr('class', 'mygraph')
    .attr('transform', 'translate(' + yAxisWidth + ', ' + titleHeight + ')');

var gx = g.append('g') // draw the axis within the plot area
    .attr('class', 'axis x')
    .attr('transform', 'translate(0,' + plotHeight + ')')
    .call(xAxis);

var gy = g.append('g')
    .attr('class', 'axis y')
    .call(yAxis);

var addCrosshair = function (sel) {
  sel.append('line')
     .attr('x1', function(d, i){ return (x(d[0])-9);})
     .attr('y1', function(d, i){ return (y(d[1]));})
     .attr('x2', function(d, i){ return (x(d[0])+9);})
     .attr('y2', function(d, i){ return (y(d[1]));})
     .attr('style', 'stroke:rgb(50,10,50);');
  sel.append('line')
     .attr('x1', function(d, i){ return (x(d[0]));})
     .attr('y1', function(d, i){ return (y(d[1])-9);})
     .attr('x2', function(d, i){ return (x(d[0]));})
     .attr('y2', function(d, i){ return (y(d[1])+9);})
     .attr('style', 'stroke:rgb(50,10,50);');
};

g.append('g')
    .selectAll('line.crosshair')
    .data(points).enter().call(addCrosshair);

</script>

</body>
</html>
